<!-- Task:
      Create a web application that has  2 pages.
      page 1
        (1) User can request the list of posts form Jsonplaceholder API and see the results collated together
        (2) User can alphabetically sort the posts based on their title
        (3) The user can group the posts by user ID
-->
<!DOCTYPE html>
<html>
  <head>
      <title>BandLab Home</title>
  </head>

  <body onload="fetchDataFromAPI()">
    

    <p id="showData"></p>


    <!-- Put script below so that the page will load first.-->
    <script>
    //Obtain data from the placeholder
    function fetchDataFromAPI()
    {
      fetch('https://jsonplaceholder.typicode.com/posts')
      .then(response => response.json()) //call json() method to transform the Response object into an object that can be interacted with
      //.then(json =>console.log(json.length))
      //Extract to HTML table
      .then(json => {

        //create dyananmic <table>
        var table = document.createElement("table");
        table.setAttribute('border', '1');
        table.setAttribute('cellspacing', '0');
        table.setAttribute('cellpadding', '5');

        //retrieve column header
        var column = []; //define an empty array
        for (var i = 0; i <json.length; i++)
        {
            for (var key in json[i]) //looping through properties of object
            {
              if(column.indexOf(key) === -1)
              {
                column.push(key);
              }
            }
        }
        //create html table header row using the extracted headers
         var tr = table.insertRow(-1); //table insertRow
         //console.log("this is tr : ", tr)

         for (var i = 0; i < column.length; i++)
         {
           var th = document.createElement("th");
           th.innerHTML = column[i]; //change the value inside th
           tr.appendChild(th); //add
         }

         //add the json data to the tabel as rows
         for (var i = 0; i <json.length; i++)
         {
           tr = table.insertRow(-1);

           for (var j = 0; j <column.length; j++)
           {
             var tabCell = tr.insertCell(-1);
             tabCell.innerHTML = json[i][column[j]];
           }
         }

         //add newly created table with json data to a container
         var divContainer = document.getElementById("showData");
         divContainer.innerHTML="";
         divContainer.appendChild(table);
          }
        ) //end of extraction to HTML table
    }
    </script>
  </body>

</html>

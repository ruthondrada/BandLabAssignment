<!DOCTYPE html>
<html>
<body>

<button id="play" >Yodel!</button>
<script>

document.getElementById('play').addEventListener('click', function() {
  //var context = new AudioContext();

  var dogBarkingBuffer = null;
  // Fix up prefixing
  window.AudioContext = window.AudioContext || window.webkitAudioContext;
  var context = new AudioContext();
  const URL = 'https://cors-anywhere.herokuapp.com/https://static.bandlab.com/soundbanks/previews/new-wave-kit.ogg'; //use this to bypas CORS issue
  const playButton = document.querySelector('#play');
  loadDogSound(URL);

  function loadDogSound(url) {
    var request = new XMLHttpRequest();
    request.open('GET', url, true);
    request.responseType = 'arraybuffer';

    // Decode asynchronously
    request.onload = function() {
      context.decodeAudioData(request.response, function(buffer) {
        dogBarkingBuffer = buffer;
      });

      playButton.onclick = () => playSound(dogBarkingBuffer);

      function playSound(buffer) {
        var source = context.createBufferSource(); // creates a sound source
        source.buffer = buffer;                    // tell the source which sound to play
        source.connect(context.destination);       // connect the source to the context's destination (the speakers)
        source.start();                           // play the source now
                                               // note: on older systems, may have to use deprecated noteOn(time);
      }
    }
    request.send();
  } //loadsound

//     (function () {
//   'use strict';
//
//   const URL = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/123941/Yodel_Sound_Effect.mp3';
//
//   const context = new AudioContext();
//   const playButton = document.querySelector('#play');
//
//   let yodelBuffer;
//
//   window.fetch(URL, { mode: 'no-cors' })
//     .then(response => response.arrayBuffer())
//     .then(arrayBuffer => context.decodeAudioData(arrayBuffer))
//     .then(audioBuffer => {
//       yodelBuffer = audioBuffer;
//     });
//
//     playButton.onclick = () => play(yodelBuffer);
//
//     function play(audioBuffer) {
//     const source = context.createBufferSource();
//     source.buffer = audioBuffer;
//     source.connect(context.destination);
//     source.start();
//   }
// }());

  });
</script>
</body>
</html>
